var Nognog=function(n,o){"use strict";var e=function(){var n,e=o.getElementsByTagName("script")[0];o.getElementById("jsrsasign-script")||((n=o.createElement("script")).id="jsrsasign-script",n.setAttribute("defer",""),n.src="//kjur.github.io/jsrsasign/jsrsasign-all-min.js",e.parentNode.insertBefore(n,e))},r=function(){var n,e=o.getElementsByTagName("script")[0];o.getElementById("fg-script")||((n=o.createElement("script")).id="fg-script",n.setAttribute("defer",""),n.src="//cdn.jsdelivr.net/npm/fingerprintjs2@2.1.0/dist/fingerprint2.min.js",e.parentNode.insertBefore(n,e))};return function(){var n,e=o.getElementsByTagName("script")[0];o.getElementById("axios-script")||((n=o.createElement("script")).id="axios-script",n.setAttribute("defer",""),n.src="//cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js",e.parentNode.insertBefore(n,e))}(),r(),e(),{config:null,init:function(n){n.podUrl?n.vendorUrl?n.vendorId?n.adminPKI?n.userPKI?this.config=n:console.error("Missing userPKI"):console.error("Missing adminPKI"):console.error("Missing vendorId"):console.error("Missing vendorUrl"):console.error("Missing podUrl")},podConnect:async function(n){if(!axios)return console.error("Could not found axios"),null;var o=this.getUserJWTToken(),e=await async function(){return new Promise((n,o)=>{Fingerprint2||(console.error("Could not found fingerprintjs2"),o(null)),Fingerprint2.get(function(e){if(e&&e.length){var r=e.map(function(n){return n.value}),t=Fingerprint2.x64hash128(r.join(""),31);n(t)}else o(null)})})}(),r=await axios.post(this.config.podUrl+"/pods/connect",{signatures:{fingerprint:e,...n}},{headers:{Authorization:`Bearer ${o}`}}).catch(function(n){console.log(n)});return 200===r.status&&r.data&&r.data.vendorAccessToken?r.data.vendorAccessToken:null},getUserJWTToken:function(){if(!KJUR)return console.error("Could not found KJUR jsrsasign"),null;var n={iss:this.config.vendorId,admin:!1,exp:KJUR.jws.IntDate.get("now + 1hour")},o=JSON.stringify({alg:"RS256",typ:"JWT"}),e=JSON.stringify(n);return KJUR.jws.JWS.sign("RS256",o,e,this.config.userPKI.priv)},getAdminJWTToken:function(){if(!KJUR)return console.error("Could not found KJUR jsrsasign"),null;var n={iss:this.config.vendorId,admin:!0,exp:KJUR.jws.IntDate.get("now + 1hour")},o=JSON.stringify({alg:"RS256",typ:"JWT"}),e=JSON.stringify(n);return KJUR.jws.JWS.sign("RS256",o,e,this.config.adminPKI.priv)},feedPodActivity:async function(n,o){if(!axios)return console.error("Could not found axios"),!1;var e=await axios.post(this.config.podUrl+"/pods/activities",o,{headers:{Authorization:`Bearer ${n}`}}).catch(function(n){console.log(n)});return e&&200===e.status},getRecommendations:async function(n,o){if(!axios)return console.error("Could not found axios"),!1;var e=await axios.post(this.config.podUrl+"/recommendations",o,{headers:{Authorization:`Bearer ${n}`}}).catch(function(n){console.log(n)});return e.status=200,e.data},feedbackRecommendation:async function(n,o){if(!axios)return console.error("Could not found axios"),!1;var e=await axios.post(this.config.podUrl+"/pods/activities",o,{headers:{Authorization:`Bearer ${n}`}}).catch(function(n){console.log(n)});return e&&200===e.status},uploadIncrementalContent:async function(n){if(!axios)return console.error("Could not found axios"),!1;var o=this.getAdminJWTToken(),e=await axios.post(this.config.vendorUrl+"/batches",n,{headers:{Authorization:`Bearer ${o}`}}).catch(function(n){console.log(n)});return console.log(e),e&&200===e.status}}}(window,document);